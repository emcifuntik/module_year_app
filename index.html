<html>
  <head>
    <script src="https://vk.com/js/api/xd_connection.js?2" type="text/javascript"></script>
    <script src="request.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var parts = window.location.href.split('&hash=');
      var photo = parts[1];
      VK.init(function() { 
        VK.addCallback('onSettingsChanged', function() {
          VK.api('wall.post', {
            message: 'Это мой вклад в экономику страны. А какой твой? @modulbank (Участвуй в конкурсе) и выиграй 50 000 рублей и полезные подарки для бизнеса: https://vk.cc/9nXJmk #Этомойвклад',
            attachments: photo,
            v: '5.73'
          }, function (data) {
            if(data.response) {
              document.querySelector('#message').innerHTML = 'Отчёт о вашем вкладе в экономику опубликован на стене. Теперь вы участвуете в конкурсе!'
              return;
            }
            document.querySelector('#message').innerHTML = 'Произошла ошибка при публикации отчёта на вашей стене. Участие в конкурсе невозможно!'
          });
        });
        VK.callMethod('showSettingsBox', 8192);
      }, function() {}, '5.92'); 
    </script>
  </head>
  <body>
    <h1 id="message"></h1>
  </body>
</html>
